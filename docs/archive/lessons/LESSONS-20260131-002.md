# AGSP 役割境界に関する知見

**電番:** LESSONS-20260131-002  
**作成日:** 2026-01-31  
**作戦:** QUARTER_VIEW_GENESIS

---

## 一、発生した問題

Phase 2 発令時、参謀総長が仕様書・発令プロンプトに**具体的な実装コード**を記載した。

### 逸脱例

```python
# 仕様書に記載してしまった例（NG）
class CameraController:
    def __init__(self, window_width: int, window_height: int):
        self.world_camera = arcade.Camera2D()
        self.gui_camera = arcade.Camera2D()
        ...
```

---

## 二、問題の本質

### AGSP核心原則違反

> **"Don't fix the code. Update the Spec."**
> （コードを直すな。仕様書を書き換えろ。）

この原則は「仕様書にコードを書け」という意味ではない。

### 役割の混同

| 役職 | 本来の担当 | 逸脱した行為 |
|------|-----------|-------------|
| 参謀総長 | 何を達成するか | どう実装するか |
| 連合艦隊 | どう実装するか | （侵犯された） |

---

## 三、正しい役割分担

### 参謀総長が決めるべきこと

- **目標**: 何を達成するか
- **成功基準**: どうなれば完了か
- **制約**: 何をしてはいけないか（情報部長警告）
- **方面軍配分**: 誰が何を担当するか

### 参謀総長が決めてはいけないこと

- **クラス設計**: どんなクラスを作るか
- **メソッドシグネチャ**: 引数・戻り値の型
- **具体的アルゴリズム**: どう計算するか
- **変数名・関数名**: 命名規則以外の具体名

### 連合艦隊が決めるべきこと

- 具体的なクラス・関数の設計
- 実装の詳細
- テストの書き方
- リファクタリング判断

---

## 四、仕様書の書き方（是正後）

### NG例（実装詳細を書いてしまう）

```markdown
## カメラ制御仕様

class CameraController:
    def __init__(self):
        self.world_camera = arcade.Camera2D()
    
    def zoom_in(self):
        idx = self.ZOOM_LEVELS.index(self.zoom_level)
        if idx < len(self.ZOOM_LEVELS) - 1:
            self.zoom_level = self.ZOOM_LEVELS[idx + 1]
```

### OK例（目標と制約のみ）

```markdown
## カメラ制御仕様

### 目標
- パン操作（WASD/矢印キー、マウスドラッグ）
- ズーム操作（整数倍：1x, 2x, 3x, 4x）

### 制約
- arcade.Camera2D を使用すること
- ズームは整数倍のみ（浮動小数点禁止）
- カメラ位置は整数にスナップすること
- ワールド用とGUI用でカメラを分離すること

### 成功基準
- WASDでスムーズに移動できる
- ズーム時に中心点がズレない
```

---

## 五、判断基準

仕様書に書く内容を迷ったら、以下を自問する：

| 質問 | 答え |
|------|------|
| これは「何を」の話か？ | → 仕様書に書く |
| これは「どうやって」の話か？ | → 連合艦隊に委ねる |
| これがないと目標が曖昧か？ | → 仕様書に書く |
| これがなくても目標は明確か？ | → 書かない |

---

## 六、AGSP改定事項

### README.md 追記

「参謀総長の役割境界」セクションを追加し、以下を明文化：

1. 参謀総長は「目標・制約・成功基準」を定義する
2. 参謀総長は「実装詳細」を決定しない
3. 仕様書にコードを書かない
4. 連合艦隊の自律性を尊重する

---

## 七、教訓

> **参謀本部は「地図を描く」。**
> **連合艦隊は「道を切り開く」。**
> 
> 地図に「ここで右足を出せ」とは書かない。

---

以上
